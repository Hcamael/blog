title: 2015XDCTF低分web题writeup
date: 2015-10-03 14:11:30
tags:
- ctf
- web 
---
![xdctf](http://7xscw6.com1.z0.glb.clouddn.com/hexo-xdctf.png)

<!--more-->
国庆两天, XDCTF, 质量和难度和上次的NSCTF都不是一个层次的...

## web1 100
`index.php~` 搞出源码:
```
<?php
$test=$_GET['test'];
$test=md5($test); 
if($test=='0') { 
    print "flag{xxxxxx}"; 
} else 
    print "you are falied!"; 
print $test;
echo "tips:知道原理了，请不在当先服务器环境下测试，在本地测试好，在此测试poc即可，否则后果自负"; 
?>
```
这题黑魔法啊!!! 真是学习了
`md5('240610708') = 0e462097431906509019562988736854`
而 `'0e462097431906509019562988736854' == '0'`

## web1 200
这题是大JAVA的题目,  可惜并不会,, 就是有个一个SessionExample界面, 可以进行设置session, (为啥需要这种东西?)
然后设置, login=true, user=Administrator

## web2 系列..
P神出的代码审计4连套, PS: P神写的站, 给你代码你也日不动~~
只搞定两题..

### web2 200
第一步是搞到源码, 题目里说了用git管理源码, 所以应该是.git 泄露了... 访问 /.git 403, 果然是....

去百度后下载了 `rip-git.pl` ,拖/.git, 拖下来了, 却不能还原源码, 估计有些重要的没拖下来..

接下来是:
```
$ git checkout master
$ git checkout -f
```
搞出来了个 `README.md`
根据里面的提示, 去网站上搞到了个 /.git/refs/tags/1.0
然后把 /.git/refs/heads/master 的hash 值用 /tags/1.0 里的hash替换
再 `$ git checkout -f`
然后就搞到源码了, 第一个200的flag就在index.php里..

### web2 100
存在强制修改任意用户密码漏洞, 管理员邮箱在首页: xdsec-cms@xdctf.com
```
payload: 
http://xdsec-cms-12023458.xdctf.win/index.php/auth/resetpwd?email=xdsec-cms@xdctf.com&verify[1]=aa
```
修改密码后登录, get 100 flag...

后面就日不动了,,, 毕竟P神...
XDCTF的web题质量都挺高的...学到了很多..